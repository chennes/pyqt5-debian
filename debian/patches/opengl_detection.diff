From aa9edd51decd034cb3f14685404517169ff8a592 Mon Sep 17 00:00:00 2001
From: Dmitry Shachnev <mitya57@gmail.com>
Date: Sat, 22 Jul 2017 10:11:07 +0300
Subject: Fixes for the OpenGL detection needed by changes in Qt v5.8.0

Origin: upstream, changeset bf6caed84fd3 (from 5.8.2 release)
Patch-Name: opengl_detection.diff
---
 configure.py | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/configure.py b/configure.py
index 474aafce..c84c58a8 100644
--- a/configure.py
+++ b/configure.py
@@ -618,7 +618,7 @@ class TargetConfiguration:
 
         out_file = 'qtdetail.out'
 
-        source = '''#include <QCoreApplication>
+        source = '''#include <QGuiApplication>
 #include <QFile>
 #include <QLibraryInfo>
 #include <QTextStream>
@@ -676,7 +676,7 @@ int main(int argc, char **argv)
 #if defined(QT_NO_OPENGL)
     out << "PyQt_OpenGL\\n";
     out << "PyQt_Desktop_OpenGL\\n";
-#elif defined(QT_OPENGL_ES_2)
+#elif defined(QT_OPENGL_ES) || defined(QT_OPENGL_ES_2) || defined(QT_OPENGL_ES_3)
     out << "PyQt_Desktop_OpenGL\\n";
 #endif
 
@@ -696,7 +696,7 @@ int main(int argc, char **argv)
 }
 ''' % out_file
 
-        cmd = compile_qt_program(self, verbose, 'qtdetail', source, 'QtCore',
+        cmd = compile_qt_program(self, verbose, 'qtdetail', source, 'QtGui',
                 debug=debug)
 
         if cmd is None:
